/**
 * Rooms - 第一幕房间数据
 * 
 * 非欧几里得空间拓扑 (Non-Euclidean Spatial Topology)：
 * - 房间连接不基于物理位置，而是基于映射字典
 * - 门的标签（应该去哪）与实际目的地（真正去哪）不一致
 * - 空间逻辑是闭环且跳跃的，无法在脑中构建平面图
 * 
 * 设计意图：
 * 让玩家失去方位感，产生"家是一个无限循环的陷阱"的心理暗示
 */

// 网格标记
const TILE = {
    FLOOR: 0,
    WALL: 1
};

const ROOMS = {
    // ========== 卧室 ==========
    BEDROOM: {
        id: 'BEDROOM',
        title: '你的卧室',
        description: '你醒了。这里是你家，但感觉...不太对。',

        // 网格布局（10x10）
        // 0 = 地板, 1 = 墙壁, 字符串 = 门或物品
        layout: [
            [1, 1, 1, 1, 1, 'DOOR_HALL', 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 'BED', 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 'PHOTO', 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 'DESK', 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        ],

        // 门的错误映射：标签说"去走廊"，实际去"厨房"
        doorLinks: {
            'DOOR_HALL': {
                label: '走廊',         // 门上的标签（骗人的）
                target: 'KITCHEN',    // 实际去的地方
                spawnX: 5,
                spawnY: 5
            }
        },

        // 玩家出生点
        spawnX: 5,
        spawnY: 5
    },

    // ========== 厨房 ==========
    KITCHEN: {
        id: 'KITCHEN',
        title: '厨房？',
        description: '这不是走廊。餐桌上有什么东西在等你。',

        layout: [
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 'KNIFE', 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            ['DOOR_BED', 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 'DOOR_BATH'],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        ],

        doorLinks: {
            'DOOR_BED': {
                label: '卧室',
                target: 'BEDROOM',  // 这个是"正确的" - 建立虚假的安全感
                spawnX: 5,
                spawnY: 5
            },
            'DOOR_BATH': {
                label: '浴室',
                target: 'BATHROOM',
                spawnX: 5,
                spawnY: 5
            }
        },

        spawnX: 5,
        spawnY: 5
    },

    // ========== 浴室 ==========
    BATHROOM: {
        id: 'BATHROOM',
        title: '浴室',
        description: '水龙头在滴水。镜子里好像有什么东西。',

        layout: [
            [1, 1, 1, 'DOOR_KITCHEN', 1, 1, 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 'MIRROR', 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        ],

        // 关键扭曲：浴室门标签说"厨房"，实际去走廊！
        doorLinks: {
            'DOOR_KITCHEN': {
                label: '厨房',         // 标签说"回厨房"
                target: 'HALLWAY',    // 实际去走廊（推进剧情）
                spawnX: 5,
                spawnY: 8
            }
        },

        spawnX: 5,
        spawnY: 5
    },

    // ========== 走廊（玩家以为要去的地方，但永远到不了）==========
    HALLWAY: {
        id: 'HALLWAY',
        title: '走廊',
        description: '走廊很长。尽头有一扇门，但你永远走不到。',

        layout: [
            [1, 1, 1, 1, 1, 'DOOR_MOM', 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 'SAVE', 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 'DOOR_BACK', 1, 1, 1, 1, 1],
        ],

        doorLinks: {
            'DOOR_MOM': {
                label: '妈妈的房间',
                target: 'MOM_ROOM',
                spawnX: 5,
                spawnY: 8
            },
            'DOOR_BACK': {
                label: '回去',
                target: 'KITCHEN',  // 不是回卧室，是到厨房
                spawnX: 5,
                spawnY: 5
            }
        },

        spawnX: 5,
        spawnY: 8
    },

    // ========== 妈妈的房间 ==========
    MOM_ROOM: {
        id: 'MOM_ROOM',
        title: '妈妈的房间',
        description: '门是锁着的。你能听到里面有声音...',

        layout: [
            [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 'KEY', 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            [1, 1, 1, 1, 'DOOR_HALL', 1, 1, 1, 1, 1],
        ],

        doorLinks: {
            'DOOR_HALL': {
                label: '走廊',
                target: 'BEDROOM',  // 关键扭曲：想回走廊，却回到卧室
                spawnX: 5,
                spawnY: 5
            }
        },

        spawnX: 5,
        spawnY: 8,

        // 战斗触发标记
        triggerBattle: true
    }
};

// 网格大小
const GRID = {
    WIDTH: 10,
    HEIGHT: 10,
    TILE_SIZE: 40  // 每格40像素
};
